{% extends "account/base.html" %}
{% load crispy_forms_tags %}

{% block head_title %}Change Password{% endblock %}

{% block content %}
    <h1>{% if token_fail %}Bad Token{% else %}Change Password{% endif %}</h1>

    {% if token_fail %}
        {% url 'account_reset_password' as passwd_reset_url %}
        <p>The password reset link was invalid, possibly because it has already been used.  Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.</p>
    {% else %}
        {% if form %}

            <div class="container pt-4 my-5">
                <div class="row">
                    <div class="col-md-12 min-vh-100 d-flex flex-column justify-content-center">
                        <div class="row">
                            <div class="col-lg-6 col-md-8 mx-auto">
            
                                <!-- form card login -->
                                <div class="card rounded shadow shadow-sm">
                                    <div class="card-header">
                                        <h3 class="mb-0">Change password</h3>
                                    </div>
                                    <div class="card-body">
                                        <form method="POST" action="{{ action_url }}">
                                            {% csrf_token %}
                                            {{ form|crispy }}
                                            <input class="btn btn-primary btn-block" type="submit" name="action" value="Change password"/>
                                        </form>
                                        <div class="row pt-2">
                                            <div class="col">
                                                <a href="/accounts/login">Return to login</a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--/card-block-->
                                </div>
                                <!-- /form card login -->
                            </div>
                        </div>
                        <!--/row-->
                    </div>
                    <!--/col-->
                </div>
                <!--/row-->
            </div>
            <!--/container-->

        {% else %}
                <div class="container pt-4 my-5">
                <div class="row">
                    <div class="col-md-12 min-vh-100 d-flex flex-column justify-content-center">
                        <div class="row">
                            <div class="col-lg-6 col-md-8 mx-auto">
            
                                <!-- form card login -->
                                <div class="card rounded shadow shadow-sm">
                                    <div class="card-header">
                                        <h3 class="mb-0">Change password</h3>
                                    </div>
                                    <div class="card-body">
                                        <p>Your password has been succesfully changed!</p>
                                        <div class="row pt-2">
                                            <div class="col">
                                                <a href="/accounts/login">Return to login</a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--/card-block-->
                                </div>
                                <!-- /form card login -->
                            </div>
                        </div>
                        <!--/row-->
                    </div>
                    <!--/col-->
                </div>
                <!--/row-->
            </div>
            <!--/container-->
        {% endif %}
    {% endif %}
{% endblock %}